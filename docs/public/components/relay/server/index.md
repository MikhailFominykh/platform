## Конфигурация комнат
Определяет список root объектов комнат и список ожидаемых пользователей с пользовательскими объектами.

Обязательно для запуска без MM сервера. Для каждого файла будет создана одна комната с заданными настройками. 
```shell script
cargo run -- --room room1.yaml --room room2.yaml ...
```

### Формат файла конфигурации комнаты
```yaml
id: 100
# автосоздание пользователя после выхода
auto_create_user: true 
# список ожидаемых пользователей
users:
  - id: 1 # id пользователя, должен быть уникальным в рамках комнаты
    private_key: [ 1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2 ]
    access_groups: 15
    # данные объекты будут созданы от имени пользователя при входе пользователя в комнату
    objects:
      - id: 100 # допустимый диапазон - 0 .. 512 - GameObjectId::CLIENT_OBJECT_ID_OFFSET
        template: 4
        access_groups: 15
        fields:
          longs:
            5: 100
            15: 200
          floats:
            3: 5.5
            7: 9.9
          structures:
            10:
              name: alex
# данные объекты будут созданы от имени Root при создании комнаты
objects:
  - id: 5
    template: 5
    access_groups: 0
    fields:
      longs: { }
      floats: { }
      structures: { }
```

## Трассировка сетевых команд

- по-умолчанию трассировка отключена
- трассировка осуществляется в INFO канал системы логирования (по-умолчания для сервера включен режим ERROR)

### Включение трассировки всех команд на сервере

```bash
cargo run -- --log-level INFO --trace-all-network-commands
```

### Настройка правил трассировки

Для более детальной трассировки используется yaml файл с описанием правил.

```bash
cargo run -- --command-trace config/tracer-config.yml --log-level INFO
```


```yaml
# разрешение на показ трейса по-умолчанию
default: allow | deny 

# правила для отображения трейсов
# применяется по-порядку, как только правило применимо к команде - процесс обработки прекращается
# поле action - обязательное, остальные нет
# если поле не задано - оно игнорируется при проверки
rules:
  - action: allow | deny
    user: some_user_key
    direction: sc | cs
    field_id: 1
    field_type: long | float | structure | event
    command: Create | Created | SetLong |IncrementLongValue | CompareAndSetLongValue | SetFloat | IncrementFloatValue | SetStruct | Event | Delete | AttachToRoom
```




## Выбор пользователя для соединения с сервером

Выбор осуществляется среди пользователей заданных в шаблоне команты.

Используется для замены работы с ММ сервером.  

```bash
curl localhost:8080/select-user/1
```
Где 1 - это id комнаты.

### Возможные ответы

Пользователь выбран для входа, вход необходимо осуществить за 5 секунд, иначе пользователь будет снова свободен для выбора.

```yaml
{"Ok":{"public_key":5,"private_key":[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5]}}
```


Комната не найдена
```yaml
{"Err":"RoomNotFound"}     
```

Нет свободного пользователя для входа

```yaml
{"Ok":null}
```



