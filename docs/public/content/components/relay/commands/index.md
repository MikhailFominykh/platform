## Прием

Для обработки входящих команд используются делегаты. Для каждого типа данных делегаты регистрируются отдельно. После
того как все необходимые делегаты зарегистрированы, необходимо периодически вызывать функцию:

```csharp
CheetahClient.Receive()
```

### Особенности использования делегатов

- Делегаты передаваемые в нативные функции не должны выбрасывать исключения, так как это приведет к зависанию клиента на
  втором вызове.

- Также нельзя из делегатов вызывать другие нативные функции, так как это приведет к блокировке клиента.

- Делегаты могут ссылаться только на статичные методы, с аннотацией \[MonoPInvokeCallback(typeof(..))\]. Иначе не будет
  работать IL2CPP.

- Нельзя использовать API из async, так как обработчик события может быть прерван, что может привести к повторному
  вызову API. А это всегда приводит к зависанию клиента.

## Отправка

Отправка команды происходит после вызова соответствующей функции. Для экономии трафика клиент собирает пакет для
отправки некоторое время.

### Возврат команд вызывающему клиенту

Если поле может быть изменено только на создателе, то ему не возвращается результат выполнения команды. Например,
команду SetLong нет смысла возвращать обратно, так как клиент и так знает на какое значение он изменил поле. Однако,
если исходя из прав доступа к полю может быть доступ на изменение у других клиентов - то результат всегда возвращается.
Если из данного правила есть исключения - они будут описаны в конкретной команде.

## Дополнительная информация

Для каждой команды дополнительно передается следующая информация:

### SourceUser

Идентификатор клиента, которые привел к вызову данной команды.

### Timestamp

Относительное клиентское время создания команды.

### SourceObject

Игровой объект, от имени которого логически была вызвана команда. Например, танк игрока A стреляет в танк игрока B. Танк
это игровой объект. Можно логически считать что стреляет не игрок, а игровой объект танк. Иногда эта информация нужна
остальным клиентам, для этого клиент A может поместить в контекст игровой объект танк.
