### Создание соединения

Для начала взаимодействия с игровой комнатой необходимо создать соединение с сервером.

```csharp 
CheetahClient.CreateClient(
      string serverAddress,            
      ushort userId,
      ulong roomId,
      ref CheetahBuffer userPrivateKey,
      ulong startFrameId,
      out ushort clientId
);    
```

**Параметры**

- serverAddress - адрес сервера
- следующие параметры должны быть определены в [конфигурации комнаты](/components/relay/configuration/room/)
    - user_id - идентификатор пользователя в комнате
    - room_id - идентификатор комнаты
    - userPrivateKey - приватный ключ пользователя
- startFrameId - начальный номер udp фрейма, 0 - при первом соединении, N - при восстановлении соединения
- clientId - идентификатор созданного соединения

Созданное соединение будет установлено как соединение по-умолчанию, все остальные команды всегда относятся к соединению
по-умолчанию.

### Проверка статуса соединения

```csharp
CheetahClient.GetConnectionStatus(out var status);

public enum CheetahConnectionStatus{
     Connecting,
     Connected,
     Disconnected
}
```

Необходимо вызывать периодически для проверки статуса соединения. При разрыве соединения оно не удаляется из реестра,
необходимо удалить его самостоятельно.

### Обработка серверных команд

```csharp
CheetahClient.Receive()
```
Обработка команд полученных с сервера. Для каждой команды вызываются соответствующие callback. Обычно вызывается в
Update методе.

### Удаление соединения

```csharp
CheetahClient.DestroyClient()
```
Серверу посылается команда закрытия соединения. Вся информация о соединении удаляется с клиента.

### Восстановление соединения при аварийном завершении приложения

Если приложение завершилось аварийно, то при рестарте можно восстановить соединение.
Для этого в процессе работы приложение должно сохранять текущий frameId в постоянное
хранилище, а при рестарте создать клиента с сохраненным frameId, добавив к нему смещение
в 200*Ps, где Ps период сохранения frameId в секундах.
Для получения frameId используется метод:

```c#
ClientCommands.GetStatistics(out var statistics);
```

Внимание - на данный момент сервер ждет клиента 10 секунд,  после этого восстановление
соединения не возможно, также сервер удалит все пользовательские объекты.
Повтороное соединение в production режиме к такому серверу запрещено.
Однако в режиме автосоздания пользователей будет создан новый пользователь и соединение будет возможно.


