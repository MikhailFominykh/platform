#
# Unit тесты серверных компонентов
#
name: Server tests
on:
  push:
    branches:    
      - lain-dono
      - kviring
      - dependabot
jobs:
  unit-test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        component:
          - auth/Cerberus
          - auth/Authentication
          - matches/Relay
          - matches/StubMatchmaking
          - matches/StubRegistry
          - matches/Factory
    steps:
      - uses: actions/checkout@v2
      - uses: actions/cache@v2.1.6
        with:
          path: |
            ~/.cargo/registry
            ~/.cargo/git
            server/${{ matrix.component }}/target
          key: cargo-unit-test-${{ matrix.component }}-${{ github.sha }}
          restore-keys: |
            cargo-unit-test-${{ matrix.component }}-
      - run: cargo test --manifest-path server/${{ matrix.component }}/Cargo.toml
